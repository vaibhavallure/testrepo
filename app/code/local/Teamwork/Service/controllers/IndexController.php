<?php
class Teamwork_Service_IndexController extends Mage_Core_Controller_Front_Action
{
    const API_USERNAME_CONFIG_PATH = 'teamwork_service/api_user/username';
    const API_PASSWORD_CONFIG_PATH = 'teamwork_service/api_user/default_key';

    protected $_apiClient = null;
    protected $_apiSession = null;

    public function _construct()
    {
        Mage::helper('teamwork_service')->fatalErrorObserver();
        error_reporting(E_ALL | E_STRICT);
        ini_set('display_errors', '1');
        set_time_limit(0);
        ob_start();
    }

    public function weborderAction()
    {
        $ordersForResend = array('2018003384','2018004075','2018004088','2017005082','2018004098','201700370','2018004108','2018004118','2018004126','2018003019','2018003921','2018003928','2018003765','2018003767','2018001321','2018000751','2018001142','2018000924','2018001831','2018003846','2017003019-B','2017006615','2017003027-B','2017006752','2017005332','2018000414','2017002944-B','2017007416','201701734-B','2017006069','2017006513','2017006521','201701231-B','2017007252','2017007443','2017007513','2017007090','2018003083','2018003874','2018002429','100007295','100007550','2017004379','100006900','201700132','100005511','100007723','201702127','2017005529','2018002368','2018003975-B','2018000733-B','2018003348','2018000381','2018001828-B','2018002516','2018002940','2018003611','2018003832','201701551','2018001383','2018001587','2018002069','2018003156','2018003381','2018003612','2018003833','2018001588','2018002301','2018002737','2018002942','2018003157','2018003613','2018000029','2018001155','2018001384','2018001589','2018002071','2018002738','2018002943','2018003614','2018000119','2018001154','2018001385','2018001590','2018002303','2018002739','2018002944','2018003159','2017008631','2018002073','2018002520-B','2018002945','2018003160','2018003383','2017008632','2018000926','2018001592','2018002074','2018002740-B','2018003617','2018000764','2018001157','2018002075','2018003385','2018000120','2018000184','2018001158','2018002304','2018002522','2018002742','2018002948','2018003162','2018003386','2018000121','2018000545','2018002077','2018002305','2018002523','2018002924','2017008636','2018000545-B','2018001389','2018001838','2018002306','2018002524','2018002744','2018002949','2018003388','2018003750','2017008637','2018000768','2018000931','2018001390','2018002525','2018002950','2018003164','2018003389','2018003621','2018001162','2018002307-B','2018002526','2018002746','2018002951','2017008615','2018000299','2018000770','2018002081','2018002527','2018002747','2017006972','2018003391','2018003623','2017008639','2018000296','2018000501','2018001164','2018001600','2018001842','2018002528','2018003392','2018003840','2018000501-B','2018001166','2018001394','2018001824','2018003167','2018003626','2018003841','2018001843','2018002311','2018002530','2018002748','2018003168','2018003842','2018000065','2018000651','2017005697','2018000773-B','2018001396','2018001603','2018002086','2018002312','2018002531','2018002749','2018001397','2018002087','2018002532','2018002750','2018003158','2018003395','2018003844','2018000775','2018001398','2018001605','2018002088','2018002314','2018002289','2018002751','2018002957','2018003170','2018003396','2018003845','2018000223','2018000776','2018001606','2018002090','2018002752','2018002958','2018003397','2018000777','2018001607','2018002091','2018002315','2018002534','2018002753','2018003172','2018003398','2018003629','2018000549','2018001169','2018002316','2018002535','2018002938','2018003630','2018001170','2018001609','2018001849','2018002093','2018002536','2018002755','2018003174','2018003631','2018003849','2018000298','2018000551','2018001171','2018002094','2018002537','2018002756','2018002960','2018003632','2018000123','2018000225','2018000552','2018000684','2018001852','2018002095','2018002757','2018003176','2018003851','2018000685','2018000780','2018002758','2018003177','2018003400','2018003852','2017008642','2018000385','2018000686','2018001173-B','2018003178','2018003636','2018003853','2018000688','2018001174','2018001405','2018001853','2018002098','2018002321','2018002540','2018003119','2018003401','2018003637','2018003854','2018000124','2018002541','2018002963','2018003402','2018001615','2018001855','2018002760','2018003403','2018003639','2018000125','2017007907','2018001407','2018001616','2018001855-B','2018002100','2018002542','2018002761','2018002966','2018003404','2018003640','2018003857','2018000689','2018001617','2018002101','2018002543','2018003181','2018003405','2018003858','2018000557','2018001179','2018001404','2018001618','2018002102','2018002325','2018002763','2018003405-B','2018001082','2018001619','2018002103','2018002326','2018002544','2018002764','2018003406','2018000127','2018000652','2018001181','2018001620','2018002104','2018003184','2018003407','2018003642','2018000608','2018000692','2018002105','2018002546','2018003408','2018003643','2018000387','2018000559-B','2018001410','2018002106','2018002328','2018002547','2018002765','2018002970','2018003409','2018003644','2018003863','2018000234','2018000388','2018000561','2018001624','2018002971','2018003410','2018000155','2018001626','2018002330','2018002549','2018002767','2018003646','2018003865','2018000003','2018000350','2018000694','2018001182','2018002333','2018002550','2018002768','2018003188','2018003412','2018001183','2018002551','2018002769','2018002690','2018003649','2018003867','2018000391','2018000565','2018001184','2018001629','2018001860','2018002552','2018002974','2018003189','2018003413','2018000392','2018001185','2018001414','2018001630','2018002112','2018002113','2018002975','2018003414','2018000567','2018002320','2018002976','2018003415','2018003652','2018003870','2018001187','2018001416','2018001863','2018002977','2018003192','2018003653','2018003871','2018001417','2018001633','2018001858','2018002116','2018002556','2018003193','2018000129','2018000300','2018000494','2018001633-B','2018001864','2018002557','2018003416','2018003654','2018000129-B','2018000237','2018000396','2018000960','2018001419','2018001866','2018002338','2018002558','2018002772','2018003418','2018001420','2018001867','2018002559','2018002773','2018002980','2018003196','2018003656','2017007151','2018001420-B','2018003197','2018000397','2018000783','2018002120','2018003198','2018003657','2018000653','2018001422','2018002121','2018002342','2018003199','2018003421','2018003658','2017006467','2018000302','2018000399','2018001423','2018001869','2018002122','2018002562','2018003200','2018003659','2018003879','2018000135','2018000784','2018001870','2018002123','2018002563','2018002984','2018003202','2018003881','2018000136','2018000401','2018001425','2018002564','2018003203','2018003424','2018003661','2018003882','2018000495','2018000611','2018001196','2018001427','2018001872','2018002565','2018002985','2018003662','2018000138','2018001197','2018001639','2018002126','2018002845','2018003427','2018003651','2018001199','2018001642','2018002127','2018002567','2018003206','2018003428','2018000142','2018000309','2018001430','2018001643','2018001875','2018002568','2018002988','2018003207','2018003429','2018003665','2018000143','2018000496','2018001200','2018001644','2018002569','2018002989','2018003208','2018003430','2018003666','2018002350','2018002571','2018002990','2018003209','2018003431','2018000785','2018001646','2018001878','2018002131','2018002572','2018002779','2018002990-B','2018003210','2018003432','2018003668','2018000156','2018000312','2018000573','2018000786','2018002132','2018002570','2018002780','2017007104','2018003211','2018003433','2018001433','2018001648','2018002573','2018002782','2018002991','2018003212','2018003434','2018000314','2018000614','2018001205','2018001434','2018001649','2018002353','2018002575','2018002783','2018002992','2018000315','2018000616','2018000787','2018002135','2018002574','2018002784','2018003214','2018003436','2018003670','2018003891','2018001207','2018001435','2018001653','2018002136','2018002355','2018002576','2018002994','2018003215','2018003437','2018003669','2018000498','2018000618','2018001208','2018001437','2018002137','2018002356','2018002786','2018002995','2018000619','2018001209','2018001655','2018001886','2018002138','2018002357','2018002578','2018002503','2018003217','2018003439','2018003672','2018003894','2018000499','2018000620','2018001210','2018001439','2018001887','2018002139','2018002579','2018003218','2018003440','2018003673','2018003894-B','2018000320','2018001658','2018001888','2018002140','2018002998','2018003219','2018003441','2018003895','2018000622','2018001212','2018001659','2018001889','2018002141','2018002580','2018002788','2018003000','2018003675','2018000788','2018001660','2018001890','2018002142','2018002581','2018002789','2018003221','2018003898','2017008646','2018000323','2018002143','2018003222','2018003444','2018003899','2018000010','2018000502','2018000654','2018001215','2018001662','2018001892','2018002144','2018002583','2018003900','2017008648','2018000325','2018002584','2018002790','2018003004','2018003224','2018003446','2018000979','2018001663','2018002146','2018002359-B','2018002585','2018002792','2018002936','2017008596','2018001895','2018002147','2018002360','2018002586','2018003005','2018003448','2017008649','2018000505','2018001443','2018001585','2018001896','2018002793','2018003227','2018003875','2017008650','2018000789','2018001220','2018001667','2018002362','2018003228','2018003676','2018003905','2018000457','2018001898','2018002588','2018003229','2018003450','2018003677','2018002457','2018000790','2018001222','2018001446','2018001899','2018002150-B','2018002589','2018002785','2018003008','2018003230','2018003452','2018003678','2018003906','2018000328','2018001223','2018001447','2018001670','2018002149','2018002366','2018002590','2018002796','2018003679','2018000656','2018001448','2018001671','2018001901','2018002151','2018002367','2018002591','2018002797','2018003232','2018000509','2018001226','2018001672','2018001902','2018002592','2018002798','2017007884','2018003233','2018003681','2018000702','2018001225','2018001449','2018001673','2018002369','2018003011','2018003234','2018003682','2018000411','2018000703','2018001449-B','2018002371','2018002735','2018003235','2018003457','2018003683','2018003907','2017008656','2018000512','2018000657','2018000704','2018001228','2018001906','2018002153','2018002370','2018002595','2018003908','2018000513','2018000791','2018001228-B','2018000981','2018001907','2018002372','2018003013','2018000462','2018001451','2018001677','2018002155','2018002597','2018003687','2018003910','2017008660','2018000012','2018000329','2018000515','2018000623','2018001453','2018002156','2017008661','2018000013','2018000624','2018002157','2018002374','2018003237','2018003689','2018003911','2018000465','2018001454','2018001679','2018002158','2018003238','2018003463','2018003690','2018003913','2018000033','2018000466','2018000705','2018001233','2018001914','2018002159','2018002376','2018003240','2018003691','2018000467','2018000574','2018000658','2018001455','2018001681','2018003020','2018003242','2018003464','2018003915','2018002160','2018002378','2018002603','2018003465','2018003692','2018003916','2017008665','2018000706','2018001457','2018002161','2018002807','2018003244','2018003466','2018003693','2018003917','2018000063','2017008666','2018000707','2018001237','2018002605','2018002808','2018003245','2018003918','2017008667','2018000016','2018000413','2018000660','2018002381','2018002809','2018003245-B','2018003468','2018000746','2018002607','2018002810','2018003469','2018003920','2018000470','2018001240','2018001920','2018002162','2018002382-B','2018003025','2018003247','2018003470','2018003696','2017008670','2018000470-B','2018001042','2018003026','2018003922','2017008671','2018000020','2018000575','2018000726','2018001242','2018001688','2018002165','2018003024','2018003472','2018003698','2018003923','2018000471','2018001243','2018001461','2018002166','2018002608','2018002774','2018003699','2017008673','2018000022','2018000795','2018001462','2018001690','2018001923','2018002167','2018002609','2018002812','2018003027','2018003474','2018000159','2018001924','2017006686','2018002385','2018002610','2018003028','2018003250','2018003475','2018003926','2018000024','2018000241','2018001692','2018002168','2018002387','2018002611','2018002814','2018003029','2018003251','2018003476','2018000071','2018000710','2018001465','2018001695','2018002169','2018002815','2018003030','2018003252','2018003477','2018003702','2018000026','2018001247','2018002816','2018003031','2018003701','2017008621','2018000028','2018001248','2018001694','2018001929','2018002172','2018002389','2018002613','2018002817','2018003248','2018003479','2018003703','2018000802','2018001017','2018001249','2018001930','2018002171','2018002390','2018002614','2018002818','2018003254','2018003480','2018003705','2018000162','2018000418','2018000714','2018001250','2018001469','2018001931','2018002391','2018002615','2018001957','2018003255','2018003481','2018003706','2018003932','2018000243','2018000419','2018001019','2018001251','2018002616','2018003035','2018003482','2018000420','201700626','2018002617','2018002601','2018003036','2018003483','2018003934','2018008677','2018000576','2018002176','2018003037','2018003256','2018003484','2017008676','2018001702','2018001934','2018002619','2018002820','2018003201','2018003709','2018003530','2018000244','2018000333','2018000718','2018002620','2018002821','2018003486','2018003710','2018003876','2018000074','2018000245','2018000424','2018000518','2018001014','2018002621','2018002823','2018003039','2018003487','2018003711','2018003935','2018000165','2018000807','2018001476','2018002179','2018002397','2017006970','2018002806','2018003040','2018003259','2018000076','2018000165-B','2018000426','2018000720','2018001706','2018002180','2018002398','2018002622','2018003260','2018003937','2018000721','2018001707','2018002623','2018002825','2018003713','2018003939','2018000428','2018000577','2018001260','2018001478','2018002624','2018003043','2018003262','2018003714','2017006298','2018000339','2018001261','2018001479','2018002183','2018002401','2018002827','2018003044','2018003715','2018003940','2018000247','2018000724','2018001263','2018001481','2018002185','2018002402','2018002828','2018003045','2018003264','2018000725','2018001264','2018001482','2018001940','2018002251','2018002829','2018003046','2018000342','2018000804','2018001483','2018002830','2018003265','2018003942','2018000171','2018000727','2018000812','2018001713','2018002188','2018002404','2018002831','2018003048','2017003581','2018001484','2018001943','2018002628','2018002833','2018000173','2018000664','2018000814','2018001268','2018001485','2018001715','2018001944','2018002629','2018002834','2018003268','2017006306','2018001486','2018002406','2018002630','2018002835','2018000253','2018000666','2018001717','2018001945','2018002407','2018002631','2018003052','2018003270','2018003946','2018002408','2018002632','2018002837','2018003053','2018003271','2018003500','2018000255','2018000668','2018001460-B','2018001947','2018002192','2018002633','2018002838','2018003054','2018003272','2018003721','2018000177','2018000257','2018001036','2018001488','2018002410','2018002634','2018002839','2018003055','2018003722','2018000818-B','2018001274','2018001949','2018002194','2018002411','2018002635','2018002839-B','2018003056','2018003503','2018000179','2018000351','2018000671','2018000819','2018001275','2018001723','2018002195','2018002636','2018002840','2018003504','2018003724','2018003949','2018000180','2018000352','2018001276','2018001490','2018002196','2018002841','2018003058','2018003505','2018003950','2018000189','2018000554','2018001278','2018002197','2018002843','2018003726','2018000182','2018000354','2018000674','2018001492','2018001726','2018001954','2018002198','2018002638','2018002844','2018003059','2018003727','2018003952','2018000821','2018001279','2018001493','2018001727','2018001955','2018002199','2018002415','2018003060','2018003953','2018000355','2018000520','2018000822','2018001280','2018001956','2018002200','2018002415-B','2018003061','2018003273','2018003509','2018001728','2018002201','2018003062','2018003510','2018003955','2018001282','2018001729','2018001850','2018003275','2018003512','2018003956','2018000259','2018000826','2018001283','2018001498','2018001729-B','2018001959','2018002203','2018002417','2018002846','2018003276','2018003513','2017004045-B','2018000261','2018000827','2018001284','2018001499','2018002204','2018002418','2018002847','2018003277','2018003511','2018000828','2018001285','2018000412','2018002419','2018002641','2018002848','2018003065','2018003278','2018003514','2018003734','2018000263','2018000731','2018000829','2018001286','2018001731','2018002206','2018002420','2018002849','2018003066','2018003961','2018000264','2018000830','2018002422','2018002644','2018003067','2018003280','2018003962','2018000265','2018001733','2018002851','2018003517','2018003736','2018003963','2018000266','2018001289','2018001501-B','2018002208','2018002423','2018002645','2018002852','2018003281','2018003518','2018000031','2018001502','2018002424','2018002647','2018002853','2018003070','2018003519','2018001967','2018002425','2018002646','2018003965','2018000834','2018001292','2018001968','2018002209','2018002427','2018002855','2018003072','2018003283','2018003740','2018000627','2018001737','2018001969','2018002426','2018002648','2018003073','2018003284','2018003521','2018003967','2018002428','2018002649','2018002857','2018003074','2018003285','2018003522','2018000732','2018002212','2018002650','2018002858','2018003286','2018000037','2018000092','2017007565','2018000628','2018000837','2018001973','2018002213','2018002431','2018002859','2018003524','2018000356','2018000838','2018001974','2018002214','2018002860','2018003289','2018003744','2018000839','2018001298','2018001506','2018001975','2018002861','2018003078','2018003290','2018000839-B','2018001299','2018001742','2018002216','2018002651','2018002862','2018003746','2018001300','2018001743','2018002217','2018002435','2018002863','2018003292','2018000194','2018000836','2018002218','2018002653','2018003293','2018003528','2018003748','2018000267','2018000522','2018000582','2018001301','2018001745-B','2018001979','2018002654','2018002736','2018003079','2018003529','2018003749','2018000583','2018002655','2018002865','2018003081','2018003295','2018003531','2018003971','2018000062','2018000268','2018000678','201702709','2018001302-B','2018001744','2018001981','2018002099','2018003082','2018003296','2018003532','2018001303','2018001982','2018002440','2018002867','2018003297','2018003533','2018003977','2018000432','2018000844','2018001509','2018001748','2018001983','2018002220','2018002441','2018002658','2018003084','2018003753','2018003978','2018000845','2018001306','2018001749','2018001984','2018003298','2018003979','2018000846','2018001305','2018001985','2018002659','2018003086','2018003535','2018003755','2018003980','2018000525','2018001751','2018002223','2018002443','2018003087','2018003536','2018003756','2018003981','2018000066','2018000134','2018000848','2018001307-B','2018001752','2018002439','2018002662','2018003973','2018000848-B','2018001308','2018001753','2018001988','2018002873','2018003537','2018003757','2018003982','2018000527','2018001308-B','2018001512','2018001754','2018002445','2018002664','2018003089','2018003983','2018000433','2018001309','2018001513','2018001990','2018002228','2018002446','2018003090','2018003302','2018003539','2018003760','2018000038','2018000631','2018000850','2018001310','2018001756','2018002229','2018002449','2018002666','2018003091','2018003303','2018003540','2018003761','2018000632','2018001757','2018002450','2018002667','2018003986','2018001516','2018001758','2018001992','2018002451','2018002668','2018002876-B','2018003304','2018003987','2018000852','2018002232','2018002452','2018002669','2018002877','2018003093','2018003306','2018003542','2018003764','2018000635','2018000736','2018000853','2018002232-B','2018002878','2018003989','2017007295','2018000853-B','2018001760-B','2018002233','2018002879','2018003308','2018003544','2018003766','2018000435','2018000637','2018001518','2018002234','2018002455','2018002671','2018003309','2018000358','2018001762','2018002456','2018002672','2018002880','2018003310','2018003768','2018003991','2018000639','2018001318','2018001997','2018002236','2018002458','2018002673','2018003546','2018000640','2018001319','2018001521','2018001764','2018002237','2018002674','2018002883','2018003312','2018003769','2018001320','2018002000','2018002238','2018002459','2018002675','2018003097','2018003313','2018003548','2018003770','2018000040','2018000198','100008437','2018000642','2018002676','2018003314','2018003771','2017003762-B','2018002240','2018002462','2018002677','2018003315','2018003992','2018000200','2018000531','2018001324','2018002003','2018002241','2018002463','2018003316','2018003552','2018003773','2018003993','2018000201','2018000443','2018000740','2018000858','2018001325','2018001767','2018002463-B','2018002884','2018003774','2018000444','2018000742','2018001528','2018002243','2018002680','2018002822','2018003100','2018003317','2018003775','2018003995','2018000534','2018000743','2018000860','2018002244','2018003101','2018003777','2018003996','2018000041','2018000204','2018000446','2018000536','2018000861','2018001530','2018002245','2018002466','2018002682','2018002886','2018003319','2018003778','2018000205','2018000447','2018000587','2018000745','2017008147','2018001089','2018001329','2018001531','2018002246','2018002467','2018002888','2018003103','2018003320','2018003555','2018003780','2018003997','2018000061','2018000588','2018001532','2018002009','2018002248','2018002467-B','2018002887','2018003321','2018003556','2018003779','2018003998','2017003360','2018000141','2018000538','2018000644','2018000748','2018000863','2018001091','2018001532-B','2018002010','2018002421','2018002685','2018003105','2018003322','2018003557','2018003999','2018000042','2018001092','2018002249','2018002468','2018002686','2018003106','2018004000','2018000750','2018001776','2018002250','2018003324','2018003559','2018003964','2018000208','2018000540','2018000590','2018000866','2018001330','2018002470','2018003325','2018003560','2018003783','2018000095','2018000449','2018000591','2018000752','2018001095','2018001257','2018002471','2018003109','2018003326','2018000541','2018000592','2018001334','2018001537','2018002252','2018002472','2018003110','2018002383','2018004003','2018000045','2018000096','2018000593','2018000869','2018001335','2018002253','2018003110-B','2018003327','2018003785','2018000594','2018000645','2018000870','2018001098','2018001538','2018001779','2018002474','2018002692','2018002892','2018003786','2018000046','2018000450','2018000870-B','2018001099','2018001539','2018001780','2018002017','2018002255','2018002475','2018002693','2018003330','2018000871','2018001781','2018002018','2018002256','2018003112','2018003563','2018003788','2017007241','2018000366','2018000872','2018002257','2018002476','2018002695','2018003332','2018000598','2018001341','2018001784','2018002477','2018002696','2018003114','2018002881','2018003565','2018000368','2018000451','2018000599','2018001342','2018002021','2018002259','2018002478','2018002697','2018002895','2018003115','2018003333','2018003566','2018003792','2018000059','2018000212','2018000277','2018000600','2018000875','2018001343','2018001785','2018002022','2018002260','2018003334','2018003793','2018001107','2018001344','2018002023','2018002699','2018002897','2018003116','2018003335','2018003794','2018000279','2018000543','2018002024','2018002262','2018002898','2018003117','2018003336','2018000878','2018001789','2018002480','2018002899','2018003117-B','2018003337','2018001347','2018001546','2018001788','2018002026','2018002701','2018002900','2018003796','2018000056','2018000281','2018000880','2018001110','2018001348','2018001547','2018002265','2018002901','2018003339','2018004010','2018000452','2018001111','2018001350','2018001790','2018002266','2018002703','2018002902','2018003573','2018004010-B','2018001112','2018000586','2018002903','2018003121','2018003797','2018000283','2018000883','2018001352','2018001549','2018001792','2018002904','2018003122','2018000058','2018001114','2018001353','2018001549-B','2018001793','2018002705','2018002906','2018003574','2018003799','2018004013','2018000453','2018001115','2018001550','2018001794','2018002268','2018002481','2018002706','2018003575','2018003800','2018004013-B','2018000646','2018001116','2018001349','2018001551','2018001795','2018002034','2018002269','2018002483','2018002708','2018003125','2018003576','2018003801','2018001117','2018001552','2018001797','2018002271','2018002484','2018002709','2018002909','2018003126','2018003346','2018003577','2018000286','2018000888','2018001796','2018002272','2018002485','2018002710','2018002908','2018003128','2018003347','2018000889','2018001554','2018001798','2018002486','2018002711','2018003129','2018000755','2018001358','2018001555','2018002038','2018002487','2018002712','2018002911','2018003580','2018003804','2018000288','2018000681','2018001120','2018001800','2018002038-B','2018002487-B','2018002713','2018003349','2018003805','2018000102','2018001557','2018001775','2018002039','2018002488','2018002714','2018002913','2018003131','2018003581','2018003806','2018000290','2018002274','2018002489','2018002715','2018002914','2018003132','2018003807','2018001123','2018001559','2018002041','2018002275','2018002490','2018002915','2018003133','2018003583','2018003809','2018000893','2018001560','2018002042','2018002491','2018002916','2018003134','2018003353','2018003584','2018003808','2018000104','2018000478','2018000894','2018001561','2018001805','2018002492','2018002917','2018003585','2018003810','2017005001','2018000395','2018000895','2018001126','2018002493','2018002918','2018003136','2018000605','2018001361','2018002277','2018002716','2018002919','2018003587','2018002832','2018000107','2017008623','2018000214','2018000377','2017006731','2018001563','2018002495','2018002920','2018003138','2018003357','2018003588','2018000899','2018001362','2018001564','2018002718','2018003137','2018003589','2018000289','2018002047','2018002719','2018003140','2018003359','2018003813','2018000110','2017008624','2018000216','2018000900','2018001129','2018001566','2018001809','2018002280','2018002496','2018002720','2018003141','2018003360','2018003590','2018002049','2018002721','2018002923-B','2018003142','2018003591','2018001131','2018001568','2018002722','2018003363','2018003592','2018003815','2018000903','2018001366','2018001569','2018002498','2018003144','2018003814','2018000113','2018001570','2018002724','2018002926','2018003816','2018000217','2018002052','2018002285','2018002499','2018002725','2018002927','2018003596','2018000116','2018002500','2018002726','2018003366','2018003597','2018003818','2018000117','2018000906','2018001136','2018001370','2018001815','2018002287','2018002728','2018003145','2018003598','2017008625','2018000485','2018001137','2018001575','2018002055','2018002502','2018002729','2018002930','2018003139','2018003368','2018003599','2017007807','2018000486','2018001138','2018001576','2018002056','2018002288-B','2018002504','2018002730','2018003146','2018003821','2017008626','2018000909','2018002932','2018003822','2018001374','2018001574','2018002058','2018002506','2018003147','2018003371','2018001375','2018002290','2018002507','2018003372','2018003602','2018001822','2018002060','2018002935','2018003149','2018003603','2018003824','2018004041','2018001579','2018001823','2018002293','2018002509','2018002733','2018002905','2018003150','2018003604','2018003825','2018000492','2018000760','2018001145','2018001580','2018002937','2018003151','2018003826','2018001377','2018001825','2018002295','2018003152','2018003361','2018003606','2018003827','2018000915','2018001378','2018002064','2018002296','2018002511','2018003607','2018000916','2018001149','2018001583','2018002065','2018002297','2018003153','2018003829','2017008627','2018000762','2018001814','2018002298','2018002514','2018003153-B','2018003830','2018000220','2018000918','2018002299','2018002939','2018004051','2018002518','2018003615','2018002946','2018003161','2018004057','2018002741','2018003618','2018004059','2018004064','2018003392-B','2018003393','2018003169','2018003843','2018004069','2018004069-B','2018002955','2018003173','2018003847','2018003635','2018001613','2018003179','2018003855','2018002967','2018002968','2018001082-B','2018003860','2018003183','2018003864','2018003866','2018002978','2018002979','2018003418-B','2018003656-B','2018003877','2018003878','2018002983','2018003422','2018003423','2018003660','2018004101','2018003204','2018003425','2018003883','2018003663','2018004104','2018003889','2018003213','2018002993','2018002996','2018003896','2018003225','2018003680','2018003909','2018003688','2018002804-B','2018002805','2018003914','2018003021','2018000626','2018003664','2018002811','2018003924','2018003700','2018002387-B','2018003253','2018003034','2018003931','2018003255-B','2018003708','2018001022','2018003258','2018002824','2018003938','2018003491','2018003717','2018003269','2018003718','2018002836','2018003719','2018003502','2018003058-B','2018003728','2018003957','2018003733-B','2018003958','2018003280-B','2018003069','2018003738','2018003282','2018003741','2018003076','2018003287','2018003743','2018003525','2018003972','2018003526','2018003527','2018002099-B','2018003752','2018003754','2018002660','2018003756-B','2018003301','2018003538','2018003984','2018003985','2018003305','2018003541','2018002670','2018002879-B','2018003960','2018003311','2018003099','2018003994','2018000533','2018003550-B','2018002465','2018003554','2018003104','2018003782','2018003329','2018003562','2018002475-B','2018003564','2018004006','2018003567','2018000600-B','2018003338','2018002267','2018003798','2018002267-B','2018003124','2018004017','2018003348-B','2018003580-B','2018004023','2018004024','2018003355','2018003586','2018003365','2018003595','2018003365-B','2018002929','2018003600','2018003372-B','2018003605','2018003152-B','2018004045','2018003609','2018004048','2018004056','2018003836','201702150','2017005706','2017003019','2018003399','100008523','2018003859','2018003190','2018000959','2018003205','201702508','2018004103','2017006223','2017005268','2017004765','2018002789-B','2018003223','100008814','2018003009','100007133','2018002154','2018003686','2018003016','201701326-B','2018004129','100006903','2018004130','2018004131','2018004132','100009533','2018004133','2017006163','2017003694','2018003478','2018001701-B','100007397','2017002950-B','2018003936','2017004223','201700843','201701965','2018003716','2018000174','2018001487','2018003723','201702228','2018003731','2018003959','201702241-B','2018001055','2017007301-B','2018003751','2018000109','2017008223-B','100005500','2017008391','2018003544-B','2018003547','2018003318','2017006861','2017003636','2018000043','100006763','2018003784','2018003331','2018001787','2017005362','2017008241','2017003167','2018003578','2017006868','2018002912','100008474','201702633','100008965','2018003356','201702634','2018003143','2018002928','2017006128','2017007674','2018003601','2018003601-B','2018004040','2017006911','100007517','2018002510','2018004047','100008258','2018004050','201700412','2018001140','2018004053','2017006995','2018004054','2017007111','2017008035','2018004055','100008503','2017007738','2018003837','2017004169-B','100007531','100009449','2018004060','2018004061','2018001839','2018004062','201700602','201700266','2017007048','100009453','2018001840','2017008401','2018004065','2018004066','2017005151','100008514','100009457','2018004066-B','2017007830','2018004067','2017004684','2017008046','2018001399','2018004071','2018004072','2018004073','2017005715','2018004074','2017004086-B','2017005435','2017005754','100007076','100008522','2018004076','2017006136','2017008051','201700616-B','2017008052','2017004318','2018004079','2017004690','2018000555','2018003638','2018004080','2017004691','2017008251','100007311','2018002762','2017004271-B','2017008195','2018004082','201700016','100009472','2018004083','2017004538','2018002969','2018004084','201701372','2018000782','2018004085','2017004383','2017005159','2018004086','2017006613','2018004087','201700985','2017007902','201700023','2017005836','2017007903','2018000236','2018004089','201700024','2017005836-B','2018003650','2018004089-B','2018004090','2017006885','2018001631','2018004091','2017007051','2017007542','2017008503','2018002115','2018004092','2017007543','2018004093','2018003873','2018004094','2018004095','2018004096','2018004097','201700361','201700426','2018004099','100008683','2018001193','2018004100','2017003967','100006366','100009491','201700202-B','2018003880','2017005851','2017008511','2018002130','2018003667','2018004105','201700435','201701649','100006871','2018004107','2017006935','100009497','2018001647','2018003890','2017008517','2018003887','2017004275','2017004700','100008564','2018003438','2018004109','2017004759','201700442','2018002999','100009282','2018001440','2018004110','2017003535','2017004642','100005642','2018000700','2018003442','2018004111','201700652','2018004112','2018004113','2017008259','2018004114','201700448','2018003901','2018004115','100006386','2017004035','100007841','2018003903','201701314','2017003971','100009054','100008087','2017006478','2017008266','2017003225','2017004327','2017004771','2017005026','100003638','2018004120','100007134','2018004121','2017004946','2018004123','2017005721','2018003236','2018004124','2018003910-B','2018004125','201701703','201701652','2017005722','2018002375','2017007691','2018004127','100008596','2018002380','2018000018','100009534','2018004134','2018004136','2017007843','2018004138','2017004844','2017004967','2018003925','2018004139','2018004141','2018001464','2018003927','2018004140','2018004142','201700479','2018004143','100008358','2017003321','2018002173','201700092','100009085','100009545','2017008432','2018003933','2018004146','2018004147','2017005726','2018004148','201701044','2017005727','2017007020','2018003485','201700235','2017004776','2017005728','100007119','2018004150','100006425','2018004151','2017005730','2018004152','2017005731','2018003041','2018004153','2018004154','2017003575','2018002182','2018004155','100007170','201700104','2017004897','2018002186','100006183','2018000082','100006184','2017007860','2018003943','201700848','201700492','2017003254','2017004850','2017004901','2017005733','2017005783','201700493','2017005734','2018001271','201700252','2017004657','2017007286','2018003720','2017006957','2018003945','2018003947','2017007071','2017008102','2018003948','201700667','201700117','201700255','2017005740','201700257','2017003867-B','2017003592','2017004711','2017008552','201700675','2017004289','2017004852','2018000823','201700506','2017004974','100008151','2017008461','201700262','201702871','2018003516','2018000521','2018002422-B','201700512','2018001966','2018003966','201700269','100006212','2018001295','2018003969','201700271-B','100009121','2018001297','2018003745','2017007302','2017006894','100007197','2017004858','2017006895','2017004859','2017006896','2017008172','2017006632','2018001747','2017006638','2018000524','2018003085','2017003616-B','100008662','2017008220','2017003353','2018002224','100008176','2018002663','2018001755','100006230','100006231','2018003762','2017007875','201701183','2017003584','2018000357','100009144','2018002235','2018003545','2017007092','100007942','2018003772','2017003632','2017003148-B','2017007925','2017005741','201700165','2018001088-B','100006756','2017008116','201700547','2017003780','2018003108','2018004002','100005760','2017006506','201702894','2017004676','2017006328','2018000047','2017003891','100005529','201700292','2018003364','2017006251','2018004007','2017006331','2017006820','100008696','2018002698','100008697','100009171','2017008476','100007966','2018001543','2018004009','2018000054','2017005063','2018003795','201700722','2017003650','2017003938-B','100007969','100009174','2018004008','2017004800','2018000881','2017004252','2017006867','2017008241-B','201701082','100009414','2018004016','2018002910','2018004004','201700735','100007981','2018004019','201700924','2018003582','2018004020','2018004022','2017003722','100008707','2018001124','2017003066','2017007879','100005790','100009423','201701092','2017007998','2018004026','2017003046','2018003358','2018004027','2017003044','2017005002','100009193','2018004028','2017004010','100007503','2018004029','2018004030','2018004031','2017003464','2018004018','2017006123','2017008351','2018002284','2018004032','2017006987','2018004035','2018004036','2018004037','201701547','2018000908','2018004038','2017003278-B','2017003470-B','201701241','2017003949','2018004039','100006558','100009438','2018002934','2018004042','2018003374','2017006208','2018000683','2018004044','100007521','100008008','2018004046','201700589','2017006916','2017006872','100008731','2018003831','2018004058','2018003387','2018003185','201702053','2017007022','2018003739','201702474','2018003811','2017007808','2017004492','2017007535','2018002602','2017007093','2017007501','2018002956','201701293','201701376','2018002776','2018001213','2017007630','2018002625','2018001941','201701867-B','2018002434','2017005798','2018000643','2018002921','2018002508','2017006023','2018000919','2018001382','2018002068','2018003155','2018000650','2018000921','2018001153','2018001829','2018002517','2018002941','2017007455','2017008628','2018000922','2018002070','2017008629','2018000923','2018002519','2017006685','2017008630','2018002072','2018002520','2017006687','2018000925','2018001156','2018001386','2018001591','2018001833','2018002740','2018003616','2018000221','2018000221-B','2018000293','2018001593','2018001835','2018002521','2018002947','2018000765','2018002076','2017007598','2017008635','2018000294','2018000766','2018000929','2018001159','2018001837','2017005581','2017006535','2018000767','2018000930','2018001596','2018002079','2018002307','2018000371','2018000769','2018000932','2018001391','2018003165','2018003390','2018004063','2018000933','2018001163','2018001841','2018000771','2018000934','2018003625','2017006537','2018000297','2018000382','2018001601','2018002310','2018002529','2018002954','2018000383','2018000546','2018000773','2018000937','2018001167','2018001395','2018001602','2018002085','2018000122','2017007400','2018001844','2018000774','2018000938','2018001604','2017007606','2018000384','2018001845','2017008640','2018000940','2018001846','2018002533','2018003627','2018001400','2018000224','2018000778','2018001401','2018001608','2018002754','2018000550','2018000941','2018001402','2018002317','2018002959','2017006600','2018000779','2018001610','2018001851','2018002318','2018003175','2018000779-B','2018001172','2018001403','2018001611','2018002319','2018002538','2018002961','2017006602','100007790','2018000226','2018000553','2018001173','2018002096','2018002539','2017006603','2018000227','2018000781','2018000943','2018002097','2018002962','2017005585','2018000228','2018000944','2018001613-B','2018002964','2018000229','2018000945','2018001175','2018001614','2017006606','2017007526','2018000230','2018000946','2018001176','2018002323','2018002965','2018004081','2017006607','2018000947','2018001177','2017006793','2017006837','2018000948','2018001178','2018000596','2018001856','2018000690','2018000949','2018001857','2018003182','2017005829','2017006610','2018000558','2018000950','2018000386','2018000951','2018001409','2018002327','2018002545','2018002640','2017006881','2018000559','2018000952','2018001409-B','2018001621','2017004583','2018000002','2018000953','2018001623','2018000693','2018000954','2018002107','2018002548','2017006548','2018000389','2018000562','2018000693-B','2018000955','2018001411','2018002108','2018003411','2017008407-B','2018000235','2018000563','2018000956','2018001413','2018002109','2017008643','2018000390','2018000695','2018001628','2018002110','2018000064','2018000696','2017003262','2018002111','2018002334','2018000566','2018000958','2018001861','2018002553','2018003869','2018000393','2018001415','2018001862','2018000128','2018000004','2018000568','2018001632','2018002335','2018002555','2018000569','2018000649','2018002336','2017007121','2018000569-B','2018001418','2018002117','2018002337','2017005772-B','2018002117-B','2018000130','2018000005','2018000571','2018000610','2018000961','2018001635','2018002118','2017004545','2018000131','2017006749','2018000151','2018000962','2018001191','2018001636','2018002560','2018002981','2018003419','2017004545-B','2018000132','2018001637','2018002341','2018000301','2018000398','2018001638','2018002561','2017005848','2018002343','2018000400','2018000697','2018000126','2018001195','2018001640','2018001871','2018002124','2018002345','2018000137','2018000306','2018000964','2018001641','2018000307','2018000572','2018000612','2018001428','2018001873','2018002347','2018002566','2018000139','2018001874','2018002987','2018000965','2018001198','2018000310','2018001876','2018002777','2018000310-B','2018001201','2018001431','2018001645','2018001877','201702676-B','2017003528-B','2018000311','2018000497','2018000966','2018001431-B','201700373','2018000145','2018000967','2018000148','2018000313','2018001880','2018002133','2018002352','2018000147','2017006704','2017007352','2018000968','2018002134','2018000149','2017008518','2018000007','2018000456','2018000969','2018001206','2018001436','2018001652','2018000008','2018000316','2018000617','2017005965','2018000317','2018000971','2018001654','2018002577','2018003216','2018003671','2018000972','2018001438','2018000319','2018000699','2018000973','2018001657','2018000621','2018000974','2018001211','2018002358','2017008647','2018000321','2018000405','2018001441','2018000322','2018000975-B','2018001421','2018000009','2018000655','2018000977','2018001214','2018001891','2018002582','2018003002','201702406-B','2017005971','2018003445','2018000032','2018000978','2018001893','2018002145','2018002359','2018000326','2018000701','2018001217','2018003447','2018000327','2018000407','2018000980','2018001218','2018001666','2018002030','2017003846','2018000982','2018002361','2018002587','2018003006','2018003449','2017003846-B','2017007358','2018001444','2018002148','2018002587-B','2018003006-B','2018003451','2017008651','2018000507','2018001668','2018002150','2018002363','2018002795','2018003007','2017008651-B','2018000983','2018001669','2018002364','201701859-B','2017008652','2018000458','2018000986','2018001900','2018003453','2018000410','2018000508','2018000987','2018001224','2018003010','2018003454','2018000988','2018003455','2017008654','2018000510','2018000989','2018001904','2018002593','2018002799','2018003456','2017008655','2018000239','2018000459','2018000511','2018000990','2018001674','2018003012','2018001675','2018003458','2017007062','2018000461','2018000992','2018002801','2018003459','201701571','2017008658','2018000514','2018000993','2018001229','2018001909','2018002373','2018003015','2018003460','2017007222','2017007278','2018000463','2018000994','2018001678','2018001910','2018003461','2018000464','2018001231','2018001678-B','2018001912','2018002599','2018002804','2018003017','2018003462','2017008662','2018000014','2018000996','2018001232','2018001913','2018003018','2017006085','2017008663','2018000014-B','2018000625','2018000999','2018001680','2018001000','2018001915','2018002805-B','2017007228','2018001456','2018001916','2017003560','2018001002','2018001683','2018001917','2018002379','2018000015','2018000469','2018001003','2018001918','2018003467','2018001004','2018001238','2018001684','2018002606','2018000154','2018000017','2018001005','2018001239','2018001685','2018002382','2017006554','2017008669','2018000792','2018001006','2018001686','2018000019','2018000661','2018001241','2018001687','2018001921','2018002164','2018003697','2018001459','2018001922','2018000021','2018000794','2018001008','2018001689','2018001922-B','2018000070','2017006557','2018001244','2018002386','2018000023','2018000709','2018000796','2018001245','2018002813','2018000797','2018001010','2017008674','2018000025','2018000798','2018001011','2018001246','2018001926','2018000160','2018000242','2018000711','2018000799','2018001013','2018001466','2018001927','2018002612','2018000049','2017006562','2018000416','2018000712','2018000800','2018001016','2018001467','2018000186','2018000417','2018000713','2018001468','2018000027','2018000803','2018001018','2018004145','2018000072','2017008675','2018000517','2018001470','2018001699','2018001932','2018002174','2018002392','2017005275','2018000072-B','2018001020','2018001253','2018001472','2018001701','2018001933','2018002393','2018000332','2018000421','2018000662','2018000716','2018001021','2018001254','2018002394','2018002618','2018003934-B','2018000073','2018000163','2018000717','2018001473','2018002175','2018004149','2017006292','2018001023','2018001256','2018001474','2018001935','2018003257','2018000001','2018000164','2018000334','2018000719','2018000805','2018001475','2018001704','2018001935-B','2017005870','2018000335','2018000425','2018000719-B','2018001024','2018001705','2018001936','2018003712','2018000246','2018001025','2018001255','2018001937','2018003489','2018000068','2018000077','2018000166','2018000337','2018000427','2018001026','2018001258','2018002399','2018003490','2018000167','2018000809','2018001028','2018001709','2018002400','2018002826','2018000078','2017007554','2018000001-B','2018001028-B','2018001710','2018001939','2018000068-B','2018000079','2018000168','2018000340','2018000810','2018001029','2018001711','2018001938','2018003492','2018000249','2018000341','2018000811','2018001027','2018003493','201701153','2018000081','2018000170','2017006653','2018001030','2018002627','2018003047','2018003494','2017006653-B','2018001031','2018001480','2018002627-B','2017004231','2017005872','2018000172','2018000250','2018000344','2018000813','2018001267','2018002405','2018003049','2018003496','2018003944','2017007424','2018000251','2018003497','2018000086','2018000665','2018000815','2018001716','2018003498','2017003254-B','2017003422-B','2018000347','2018000729','2018003499','2018000085','2018000175','2018000348','2018000816','2018001033','2018001460','2018001718','2018001946','2017007485','2018000176','2018000349','2018000817','2018001037','2018001273','2018002409','2018000669','2018002193','2017007642','2018000178','2018000670','2018001038','2018001489','2018001721','2018001039','2018001950','2018002412','2018001041','2018001724','2018000181','2018000353','2018001953','2018002413','2018003506','2018002414','2018003507','2018000183','2018000258','2018003508','2018001494','2018003954','2017007287','2018000233','2018001040','2018001281','2018001496','2018001958','2018002416','2017006498','2018000190','2018000825','2018001043','2018001497','2018002202','2018000429','2018001045','2018000089','2018000157','2018000191','2018001046','2018001730','2018001960','2018000730','2018001047','2018001961','2017006857','2017007560','2018001048','2018002643','2018003279','2018000430','2018001287','2018001732','2018001963','2018000676','2018000831','2018001288','2018001964','2018003068','2017005523','2018000832','2018001734','2017005984','2018001050','2018001290','2018000091','2017006720','2018001051','2018001291','2018001503','2018002210-B','2017005986','2017006570','2018001052','2018001504','2018001736','2018001052-B','2018001293','2018001053','2018001294','2018001738','2018001970','2018002211','2018001053-B','2018001739','2018003742','2018000192','2018001054','2018001296','2018000677','2018001740','2017007301','2018001741','2018002215','2018002433','2018001507','2018000431','2018000473','2018000581','2018000840','2018001057','2018001977','2018002982','2018000629','2018001058','2018001745','2018001978','2018002864','2018000841','2018002219','2018001060','2018001302','2018001980','2017005293','2018000195','2018000523','2018002656','2018003976','2017005884','2018001062','2018002657','2018001061','2018001304','2018001063','2018001505','2018002442','2018000150','2018000733','2018001064','2018001510','2018001750','2018002870','2018001065','2018003300','100007982-B','2018000474','2018000584','2018001066','2018001987','2018000526','2018001067','2018002444','2018003088','2017005798-B','2017007577','2018000585','2018000849','2018001068','2018001989','2018002227','2018000630','2018001069','2018001991','2018000528','2018000851','2018001515','2018002230','2018002876','2018000633','2018001073','2018001311','2018002231','2017007237','2018000634','2018001075','2018001312','2018001517','2018001994','2017006816','2018000269','2018001074','2018001760','2018003095','2018000434','2018000636','2018000737','2018001077','2018001315','2018000271','2018000737-B','2018001078','2018001316','2018001761','2018000476','2018000638','2018000854','2018001079','2018001519','2018001998','2017007586','2018000437','2018000529','2018000738','2018001520','2018001763','201701891-B','2018000197','2018000438','2018001081','2018001999','2018002460','2018000039','2018000530','2018001523','2018000440','2018000739','2018000855','2018001083','2018001524','2018001765','2018002001','2018002239','2018000359','2018000441','2018000741','2018001322','2018001766','2018002002','2018000238','2018000442','2018000741-B','2018000857','2018001526','2018002679','2017005804','2018001087','2018001527','2018000202','2018000859','2018001768','2018002005','2018002464','2018000067','2018000185','2018000203','2018000445','2018001327','2018001529','2018001769','2018002006','2018002681','2018003553','201701440','2018001086','2018001770','2017006502','2018000274','2018000537','2018002008','2018002683','2018000206','2018000448','2018000532','2018001090','2018001326','2017006730','2018001331','2018001773','2018000539','2018000589','2018000749','2018000864','2018001332','2018001774','2018002011','2018000207','2018000275','2018000360','2018000589-B','2018000865','2018001093','2018001333','2018001534','2018002889','2018003107','2018001535','2018000209','2018000276','2018000361','2018000867','2018002014','2018002689','2018002890','201702892','2018000210','2018000362','2018000868','2018001097','2018001778','2018001096','2018001495','2018002015','2018002691','2018002891','201700715-B','2017007030-B','2018000363','2018002016','2018002254','2018003111','2018002893','2018003111-B','2017007240','2018001100','2018002694','2018000048','2017006508','2018000597','2018001340','2018000050','201702610','2018000367','2018000542','2018000874','2018001102','2018001511','2018002020','2018002258','2018002894','2018003791','2018000873','2018001104','2018001540','2018001783','2018000051','2018000369','2018001105','2018001541','2018002896','2018000052','2018000278','2018000370','2018001542','2018001786','2018002261','2018000053','2018000601','2018000753','2018000877','2018001106','2018001345','2018002479','2017006514','2018000280','2018000372','2018001346','2018001544','2018002025','2018002700','2018003570','2018000055','2018000280-B','2018000373','2018000603','2018000879','2018001109','2018002264','2018003118','201700297-B','2018000374','2018002027','2018002702','2018000057','2018000282','2018001548','2018002028','2018000282-B','2018001351','2018001791','2018000604','2018001113','2018002031','2018000098','2018000284','2018000604-B','2018000884','2018000754','2018000885','2018001354','2018002033','2018000152','2018000886','2018004014','2018000099','2017006586','2018001553','2018002036','S2017000029','2018000100','2017006587','2018000287','2018001118','2018002037','2018000287-B','2018001119','2018001556','2018000477','2018001121','2018000891','2018001121-B','2018001558','2018001802','2018002040','2018000101','2018000291','2018000892','2018001804','2017006592','2018001125','2018001360','2018002043','2018003135','2018003354','2018000106','2018001562','2018001664','2018002044','2018002276','2018000106-B','2018000896','2018001127','2018001562-B','2018001806','2018002494','2017006666','2018000475','2018000756','2018000898','2018001128','2018002278','2018000108','2018002046','2018002278-B','2018000108-B','2018000215','2018000480','2018000757','2018001363','2018001565','2018001808','2017006593','2017007250','2018001364','2018002923','2018000454','2018000901','2018001365','2018001567','2018001810','2018002281','2018000111','2018000902','2018001365-B','2018001811','2018002282','2018001132','2018001812','2018002050','2018002283','2018002925','2018003594','2017007510','2018000482','2018000904','2018001133','2018001367','2018001813','2018000115','2018000904-B','2018001813-B','2018000682','2018001135','2018001369','2018001573','2018002053','2018000484','2018000759','2018002054','2018003367','2018003819','2018000118','2018000907','2018001371','2018000648','2018001372','2018001817','2018002931','2018000487','2018001818','2018002505','2018000488','2018001141','2018001819','2018002291','2018000218','2018000489','2018001577','2018001821','2018002059','2018000219','2018000911','2018001578','2018002292','2017005893','2018000912','2018001376','2018002061','2018003373','2017006913','2018000913','2018002062','2017005748','2018000761','2018000914','2018002063','2017005190','2018001148','2017005703','2018001379','2018001827','2018003608','2017006402','2018000917','2018001150','2018001380','2018001584','2017005072','2018001151','2018001584-B','2018001828','2018002515','2018003382','2018002270','2018003835','2018002083','2018003394','2018004078','2018003180','2018003186','2018002329','2018001859','2018003868','2018002554','2018003872','2018003194','2018003655','2018003420','2018002128','2018002778','2018002351','2018003435','2018002354','2018001884','2018003001','2018001894','2018002794','2018002594','2018002598','2018002600','2018003694','2018003246','2018002384','2018003929','2018002396','2018003488','2018002626','2018003266','2018003050','2018003051','2018003501','2018001952','2018002637','2018000820','2018003063','2018003735-B','2018003737','2018002854','2018003071','2018002856','2018003968','201701419','2018003075','2018003523','2018003077','201701599','2018002652','2018002219-B','2018002438','2018002221','2018002222','2018002872','2018002665','2018003092','2018003763','2018003551','2018002007','2018002684','2018002469','2018004001','2018001337','2018003572','2018002704','2018002704-B','2018003123','2018004025','2018003790','2018002279','2018002051','100006809','2018001581','2018002512','2018003834','2018003839','2018003884','2018003886','2018003888','2018003930','2018001230','2018003261','2018003571','2018003161-B','2018003845-B','2018002412-B','2018003975','2018002670-B','2018003095-B','2018002679-B','2018003996-B','2018003822-B','2018002302','2018002952','2018001844-B','2017007743','2018001402-B','2018001854','201700620-B','2018000232','2018002966-B','2018000232-B','2017006354','2018000564','2018002339','2018002560-B','2018002125','2018003885','2018000967-B','2017007356','2018000975','2018003219-B','2018003443','2018000504','2018000504-B','2018004117','2018000507-B','2018001905','2018003012-B','2018003463-B','2017008663-B','2018003695','2017008672','2018000709-B','2017006168-B','2018000049-B','2018004144','2018001933-B','2018002177','2018000187','2018000246-B','2018003042','2018000077-B','2018000167-B','2018000080','2018001712','2018003264-B','201702866','2017004337','2018001489-B','2018000673','2018003730','2017007082','2018000580','2017007296','2017007787','2018003524-B','2018001976','2018003747','2017006183','2018001508','2018003297-B','2018000734','2018002874','2018001991-B','2018002454','2017006652','2018003549','2017007168-B','2018003558','2018002014-B','2018002890-B','2018000362-B','2017004510','2018002019','2017008481','2017005630','2017007658','2017006581','2018003344','2018001356','2017003001','2018003810-B','2018002044-B','2018003589-B','2018001130','2018003362','2018003817','2018004033','2018002057','2018003823','100009207','2018002734','2018003828','2017007106','201702139','2017006445','2018001381','2018003154');
        
        $webStaging = Mage::getModel('teamwork_transfer/webstaging');
        foreach($ordersForResend as $orderForResend)
        {
            $order = Mage::getModel('sales/order')->loadByIncrementId($orderForResend);
            
            $webStaging->generateWeborderFromOrder($order);
        }
    }
    
    public function ecmAction()
    {
        $request = $this->getRequest();
        $id = $request->getParam('id', false);
        $date = $request->getParam('date', false);
        $api = $request->getParam('api', true);

        if(!empty($id) && !empty($date))
        {
            $dir = Mage::helper('teamwork_service')->getTempDir() . $date . DIRECTORY_SEPARATOR . $id;
            if ($handle = opendir($dir))
            {
                Mage::getSingleton('core/resource')->getConnection('core_write')->delete(Mage::getSingleton('core/resource')->getTableName('service'), array(
                    'request_id = ?'     => $id
                ));

                while (false !== ($file = readdir($handle)))
                {
                    if ($file != "." && $file != ".." && !is_dir($file))
                    {
                        $content = base64_encode(file_get_contents($dir . DIRECTORY_SEPARATOR . $file));
                        if( $api )
                        {
                            $response = $this->_apiCall('getdata', array($content, false));
                        }
                        else
                        {
                            $response = Mage::getSingleton('teamwork_service/api')->getdata($content, false);
                        }
                        echo htmlentities( base64_decode($response) );
                    }
                }
                if( $api )
                {
                    $this->_destroyApiConnectionAction();
                }
                closedir($handle);
            }
        }
    }
    
    public function lostOrdersAction()
    {
        $db = Mage::getSingleton('core/resource')->getConnection('core_write');
        $coloumn = !empty($_GET['status']) ? 'status' : 'state';
        $sql = "SELECT sord.increment_id, sord.state, sord.`status`, sord.created_at FROM
            " . Mage::getSingleton('core/resource')->getTableName('sales_flat_order') . " sord
        LEFT JOIN " . Mage::getSingleton('core/resource')->getTableName('service_weborder') . " web ON web.OrderNo=sord.increment_id
            WHERE sord.`{$coloumn}`='complete' and web.WebOrderId is null and sord.created_at>'2015-06-28'
        order by sord.created_at DESC";
        $result = $db->fetchAll($sql);
        echo '<pre>';
            print_r($result);
        echo '</pre>';
    }

    public function forcestartAction()
    {
        $request = $this->getRequest();
        $id = $request->getParam('id', false);
        if(!empty($id) && preg_match('/^\{?[A-Z0-9]{8}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{12}\}?$/i', $id))
        {
            $db = Mage::getSingleton('core/resource')->getConnection('core_write');
            $db->update(Mage::getSingleton('core/resource')->getTableName('service'), array('status' => 'new'), "request_id = '{$id}'");
            Mage::helper('teamwork_service')->runStaging($id);
        }
    }

    public function forcestartstreightAction()
    {
        $request = $this->getRequest();
        $db      = Mage::getSingleton('core/resource')->getConnection('core_write');

        $id = $request->getParam('id', false);

        // if 'last_ecm' param exists in params, we will process last (most recently created) ECM
        if ($processLastId = $request->getParam('last_ecm', false))
        {
            $select = $db->select()
                ->from(Mage::getSingleton('core/resource')->getTableName('service'), array('request_id'))
            ->order('rec_creation DESC');

            $id = $db->fetchOne($select);
        }

        if(!empty($id) && preg_match('/^\{?[A-Z0-9]{8}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{4}-[A-Z0-9]{12}\}?$/i', $id))
        {
            $db->update(Mage::getSingleton('core/resource')->getTableName('service'), array('status' => 'new'), "request_id = '{$id}'");
            try
                {
                    $transferModel = Mage::getModel("teamwork_transfer/transfer");
                    $transferModel->run($id);
                }
                catch (Exception $e) //catch errors not caught by transfer model
                {
                    echo 'unxpected errors:<br/>';
                    print_r($e->getMessage());
                }

                if ($transferModel->hasWarningMsgs()) //print transfer warning messages
                {
                    echo '<br/><br/>warnings:<br/>';
                    print_r($transferModel->getWarningMsgs());
                }

                if ($transferModel->hasErrorMsgs()) //print transfer error messages
                {
                    echo '<br/><br/>errors:<br/>';
                    print_r($transferModel->getErrorMsgs());
                }

                $select = $db->select()
                    ->from(Mage::getSingleton('core/resource')->getTableName('service'), array('status'))
                ->where('request_id = ?', $id);
                $status = $db->fetchOne($select);

                echo "<br/><br/>Ecm status:<span id='ecm-status'>{$status}</span>"; //print ecm status
        }
    }

    public function twAction()
    {
        $request = $this->getRequest();
        $call = $request->getParam('call', false);
        if ($call !== false && array_search($call, get_class_methods('Teamwork_Service_Model_Api')) !== false)
        {
            $xml = $request->getParam('xml', false);
            $second = ($xml !== false ? array(str_replace(' ', '+', $xml)) : array());
            $this->getResponse()
                ->clearHeaders()
                ->setHeader('Content-Type', 'text/xml')
            ->setBody(base64_decode($this->_apiCall($call, $second)));
            $this->_destroyApiConnectionAction();
        }
        /*
             * getorders
             * getsettings
             * getversion

             * setmapping
             * setstatus
         */
    }

    public function ecmsAction()
    {
        $request = $this->getRequest();
        $id = $request->getParam('id', false);

        if($id !== false)
        {
            $this->getResponse()
                 ->clearHeaders()
                 ->setHeader('Content-Type', 'text/xml')
            ->setBody(base64_decode($this->_apiCall('getecmstatus', array(base64_encode('<?xml version="1.0" encoding="UTF-8"?><EcmHeaders><EcmHeader EcmHeaderId="' . $id . '"/></EcmHeaders>')))));
            $this->_destroyApiConnectionAction();
        }
    }

    public function getversionAction()
    {
        header('Content-Type: text/xml');
        $version = '<?xml version="1.0" encoding="UTF-8"?>';
        $version .= '<PluginInformation Name="Service Teamwork Plug-in for Magento" Version="' . Mage::getConfig()->getNode('modules')->children()->Teamwork_Service->version . '"> Description of Plug-in. Plug-in for Magento ' . Mage::getVersion() . ' created by Teamwork Retailer Co. </PluginInformation>';
        $this->getResponse()
             ->clearHeaders()
             ->setHeader('Content-Type', 'text/xml')
             ->setBody($version);
    }

    protected function _createApiConnectionAction()
    {
        if(empty($this->_apiClient))
        {
            $httpClient = new Zend_Http_Client;
            $httpClient->setConfig(array('timeout' => 6000));

            $this->_apiClient = new Zend_XmlRpc_Client(Mage::getUrl('api/xmlrpc'), $httpClient);

            $configObject = Mage::getConfig();
            $apiUser = (string)$configObject->getNode(self::API_USERNAME_CONFIG_PATH);
            $apiPassword = (string)$configObject->getNode(self::API_PASSWORD_CONFIG_PATH);

            $this->_apiSession = $this->_apiClient->call('login', array($apiUser, $apiPassword));
        }
    }

    protected function _apiCall($action, $array=array())
    {
        $return = '';
        try
        {
            if (isset($_GET['straight']))
            {
                $api    = Mage::getModel('teamwork_service/api');
                $return = call_user_func_array(array($api, $action), $array);
            }
            else 
            {
                $this->_createApiConnectionAction();
                $return = $this->_apiClient->call('call', array($this->_apiSession, "service.{$action}", $array));
            }
        }
        catch(Exception $e)
        {
            Mage::log($e->getMessage());
            Mage::log($e->getTraceAsString());
        }
        return $return;
    }

    protected function _destroyApiConnectionAction()
    {
        if (!empty($this->_apiClient) && !empty($this->_apiSession))
        {
            $this->_apiClient->call('endSession', array($this->_apiSession));
        }
    }

}