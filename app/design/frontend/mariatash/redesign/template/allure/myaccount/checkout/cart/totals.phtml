<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
/**
 * Shopping cart totals template
 *
 * @see Mage_Checkout_Block_Cart_Totals
 * @var $this Mage_Checkout_Block_Cart_Totals
 */
    $customer = Mage::getSingleton('customer/session');
?>

<?php if ($this->canApplyMsrp()): ?>
    <div class="cart-msrp-totals"><?php echo $this->__('ORDER TOTAL WILL BE DISPLAYED BEFORE YOU SUBMIT THE ORDER'); ?></div>
<?php else: ?> 
	
	<div class="myaccount-cart-total">
	<img class="myaccount-cart-card-img" src="<?php echo $this->getSkinUrl('images/myaccount/done-cart.png')?>" >

    <table id="shopping-cart-totals-table" class="totals-table">
        <col />
        <col width="1" />
        <?php
        	$_checkoutstepHelper = Mage::helper('checkoutstep');
        	if((strtolower(Mage::getSingleton('checkout/session')->getQuote()->getDeliveryMethod())==strtolower($_checkoutstepHelper::TWO_SHIP))){
        ?>
        
        	<?php
            		$totals1 = $this->getOrderedQuote()->getTotals();
            		$totals2 = $this->getBackorderedQuote()->getTotals();
            		$gradtotal1 = 0;
            		$grandtotal2  = 0;
            		$grandtotal = 0;
            		$gradtotal1 = $totals1['grand_total']->getValue();
            		$gradtotal2 = $totals2['grand_total']->getValue();
            		$grandtotal = $gradtotal1 + $gradtotal2;
            		
            		$subtotal1 = 0;
            		$subtotal2 = 0;
            		$subtotal = 0;
            		$subtotal1 = $totals1['subtotal']->getValue();
            		$subtotal2 = $totals2['subtotal']->getValue();
            		$subtotal = $subtotal1 + $subtotal2;
            		
            		$shipping1  = 0;
            		$shipping2  = 0;
            		$shipping  = 0;
            		
            		$discount1 = 0;
					$discount2 = 0;
					$discount = 0;
					
					$tax = 0;
					$tax1 = 0;
					$tax2 = 0;
            		
            		if(isset($totals1['shipping'])&& $totals1['shipping']->getValue()) {
					 	$shipping1 = $totals1['shipping']->getValue(); 
					}
					if(isset($totals2['shipping'])&& $totals2['shipping']->getValue()) {
					 	$shipping2 = $totals2['shipping']->getValue(); 
					}
					$shipping = $shipping1 + $shipping2;
					
					if(isset($totals1['discount'])) {
					 	$discount1 = $totals1['discount']->getValue(); 
					}
					if(isset($totals2['discount'])) {
					 	$discount2 = $totals2['discount']->getValue(); 
					}
					$discount = $discount1 + $discount2;
					
					if(isset($totals1['tax'])) {
					 	$tax1 = $totals1['tax']->getValue(); 
					}
					if(isset($totals2['tax'])) {
					 	$tax2 = $totals2['tax']->getValue(); 
					}
					$tax = $tax1 + $tax2; 
            	?>
       		<tfoot>
            	 <?php //if($tax > 0): ?>
            	 <tr class="summary-total">
						<td style="" class="cart-subtotals-left" colspan="1">
							<div class=""><?php echo $this->__('Estimated Tax') ?> <?php echo ($customer->getTaxCountry() && $customer->getTaxCountry() != 'US') ? sprintf('<br/><div style="font-size:90%"> (%s Sales or VAT)</div>',$customer->getTaxCountry()) : '';?></div>
						</td>
						<td style="" class="cart-subtotals-right"><span class="price"><?php echo $this->helper('checkout')->formatPrice($tax) ?>
						</span></td>
				 </tr>
				 <?php //endif; ?>
            	
            	  <tr>
					<td class="cart-subtotals-left" colspan="1">
						<strong><span class="non-total-title">Grand Total</span><span class="total-title">Total</span></strong>
					</td>
					<td class="cart-subtotals-right">
						<strong><span class="price"><?php echo $this->helper('checkout')->formatPrice($grandtotal) ?></span></strong>
					</td>
				</tr>
            	
        	</tfoot>
        	<tbody>
            	<tr class="title_total">
					<td colspan="4"><div class="title_total"> Summary of charges</div></td>
					</tr>
					<tr>
						<td class="cart-subtotals-left" colspan="1">
							<span class="subtotal">Subtotal</span><span class="merchandise">Merchandise</span>    </td>
						<td class="cart-subtotals-right">
							<span class="price"><?php echo $this->helper('checkout')->formatPrice($subtotal) ?></span>    </td>
					</tr>
					<tr id="mt-shipping">
				
				
						<td style="" class="" colspan="1">
							<a style="color: #3f4048; text-decoration: none; cursor: normal;" class="mt-shipping-method">
							<span class="shipping-label">Shipping</span>

							<span class="non-shipping-label">United States Postal Service - Priority Mail Express</span></a>
						</td>
						<td style="" class="a-right">
							<a style="color: #3f4048; text-decoration: none; cursor: normal;" class="mt-shipping-price">
							<span class="price"><?php echo $this->helper('checkout')->formatPrice($shipping) ?></span></a>
						</td>
					</tr>
					
					<?php if($discount != 0): ?>
					<tr>
						<td colspan="1" style="" class="cart-subtotals-left">
							Discount
						</td>
						<td style="" class="cart-subtotals-right">
							<span class="price"><?php echo $this->helper('checkout')->formatPrice($discount) ?></span>            
						</td>
					</tr>
					<?php endif;?>
        	</tbody>
        <?php } else{?>
        	 <tfoot>
            <?php if (!$this->getIsVirtual()): echo $this->getChildHtml('shipping'); endif; ?>
            <?php echo $this->renderTotals('footer'); ?>
        </tfoot>
        <tbody>
        
            <?php echo $this->renderTotals();?>
        </tbody>
        <?php }?>
    </table>
    </div>
<?php endif; ?>
