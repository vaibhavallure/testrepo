<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_iphone
 * @copyright   Copyright (c) 2012 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php
    $checkout = Mage::getSingleton('checkout/session')->getQuote();
    $billing = $checkout->getBillingAddress();
    $shipping = $checkout->getShippingAddress();
?>
<div class="shipping-address-mt">
	<h4 class="info-text-two">
		<?= $this->__('Shipping Address')?>
	</h4>
    <div class="address-section row">
       	<address class="col float-left">
       		<?= $shipping->getFormated('html');?>
      	</address>
      <?php if( $this->helper('customer')->isLoggedIn() ): ?>
      	<span class="col review-edit text-right">
      		<a class="link-button" href="javascript: accordion.openSection('opc-shipping');">
      			<?= $this->__('Edit')?>
      		</a>
      	</span>
      <?php endif; ?>
  	</div>
</div>

<div class="billing-address-mt">
	<h4 class="info-text-two">
		<?= $this->__('Billing Address')?>
	</h4>
    <div class="address-section row">
    	<address class="col float-left">
        	<?= $billing->getFormated('html');?>
      	</address>
		<?php if( $this->helper('customer')->isLoggedIn() ): ?>
        	<span class="col review-edit text-right">
        		<a class="link-button" href="javascript: accordion.openSection('opc-shipping');"><?= $this->__('Edit')?></a>
        	</span>
		<?php endif; ?>
    </div>
</div>

<div class="shipping-method-mt">
	<h4 class="info-text-two">
		<?= $this->__('Shipping method')?>
	</h4>
  	<div class="row">
    	<div class="col float-left">
    		<p class="para-normal"><?= $shipping->getShippingDescription() ?></p>
		</div>
		<span class="col review-edit text-right">
			<a class="link-button" href="javascript: accordion.openSection('opc-shipping_method');"><?= $this->__('Edit')?></a>
		</span>
	</div>
</div>

<div class="payment-method-mt">
	<h4 class="info-text-two">
		<?= $this->__('Payment method')?>
	</h4>
  	<div class="row">
  		<div class="col float-left">
            <?php
            $payment = $checkout->getPayment();
            switch ($payment->getMethod()) {
                case 'authorizenet':
                    $cardTypes = Mage::getModel('payment/config')->getCcTypes();
                    $cardTypeName = $cardTypes[$payment->getCcType()];
                    $cardLast4 = $payment->getCcLast4();
                    echo '<p class="para-normal">' . $cardTypeName . ' XXX XXX XXX ' . $cardLast4 . '</p>';
                    break;
                default:
                    echo '<p class="para-normal">' . $payment->getMethodInstance()->getTitle() . '</p>';
                    break;
            }
            ?>
  		</div>
		<span class="col review-edit text-right">
			<a class="link-button" href="javascript: accordion.openSection('opc-payment');"><?= $this->__('Edit')?></a>
		</span>
	</div>
</div>

<script type="text/javascript">
//<![CDATA[
    truncateOptions();
//]]>
</script>

<div id="checkout-review-submit">
    <?php echo $this->getChildHtml('agreements') ?>
    <div class="buttons-set" id="review-buttons-container">
    	<?php $baseGrandTotal = Mage::helper("currencymanager")->getGrandTotalWithBaseCurrency();?>
    	<?php $currentCurrency = strtoupper(Mage::app()->getStore()->getBaseCurrencyCode());?>
    	<?php if(!empty($baseGrandTotal)):?>
        <p class="mt-review-charge-note"><strong>Note: </strong>
        <?php echo $this->__("All orders are charged in ".$currentCurrency.". You will be charged ".$baseGrandTotal);?>
        </p>
        <?php endif;?>
        <p class="para-normal clear-both"><?php echo $this->__('Please review the information above, then click "CHECKOUT" below.') ?>
        	<a href="<?php echo $this->getUrl('checkout/cart') ?>"><?php echo $this->__('') ?></a>
        </p>
        <div>
            <p><span id="reviewSignupEmail-btn" class="btn p-0">Sign up for our Newsletter</span></p>
        </div>
        <div class="checkout-privacy-policy">
        	<p class="control f-left">
                <label for="checkout_privacy_confirm" class="custom-checkbox custom-checkbox-two para-normal"><?php echo $this->__('I understand the terms and conditions of the Maria Tash <a class="checkout_privacry_link" href="/privacy-policy" target="_black">privacy policy</a>.') ?>
                	<input type="checkbox" name="checkout_privacy_confirm" id="checkout_privacy_confirm" class="checkbox" />
                	<span class="checkmark"></span>
                </label>
       		</p>
    	</div>
      
        <?php echo $this->getChildHtml('button') ?>
        <span class="please-wait" id="review-please-wait" style="display:none;">
            <img src="<?php echo $this->getSkinUrl('images/opc-ajax-loader.gif') ?>" alt="<?php echo $this->__('Submitting order information...') ?>" title="<?php echo $this->__('Submitting order information...') ?>" class="v-middle" /> <?php echo $this->__('Submitting order information...') ?>
        </span>
    </div>
 	<!-- <p class="text-right back-link"><a href="#" onclick="checkout.back(); return false;"><?php //echo $this->__('Back') ?></a></p> -->
    <script type="text/javascript">
    //<![CDATA[
        review = new Review('<?php echo $this->getUrl('checkout/onepage/saveOrder') ?>', '<?php echo $this->getUrl('checkout/onepage/success') ?>', $('checkout-agreements'));
    //]]>
    </script>
</div>



<div class="reviewSignupEmail">
    <div class="pop-up-cover">
            <div class="pop-title modal-header">
                <a href="#close" title="Close" class="close exit-large" style="z-index: 1">
                    <img class="d-lg-block d-md-block d-none" src="<?php echo $this->getSkinUrl('images/redesign/login-cross.png'); ?>" alt="x">
                    <img class="d-block d-lg-none d-md-none" src="<?php echo $this->getSkinUrl('images/redesign/exit-small-grey.png'); ?>" alt="x"> </a>
            </div>
            <div class="body modal-body p-0">
                <?= $this->getLayout()->createBlock('cms/block')->setBlockId('review_signup_popup')->toHtml();?>
            </div>
    </div>
</div>

<script>
    jQuery("#reviewSignupEmail-btn").on('click',function(){
        jQuery(".reviewSignupEmail").css({"opacity":"1","pointer-events":"auto"});
        unScrollBody();
    });
    jQuery(".reviewSignupEmail .close").on('click',function(){
        jQuery(".reviewSignupEmail").css({"opacity":"0","pointer-events":"none"});
        scrollBody();
    });
</script>
