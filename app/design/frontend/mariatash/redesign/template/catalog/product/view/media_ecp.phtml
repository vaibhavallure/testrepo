<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     default_modern
 * @copyright   Copyright (c) 2011 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

/**
 * Product media data template
 *
 * @see Mage_Catalog_Block_Product_View_Media
 */
?>
<?php
$_product = $this->getProduct();
$_helper = $this->helper('catalog/output');

?>
 <?php $count = count($this->getGalleryImages()); ?>

<?php if ( $count >= 1 ): ?>
        <?php $counter = 1; ?>
        <div id="imageRepo">
            <?php foreach ($this->getGalleryImages() as $_image): ?>       
                <img src="<?php echo $this->helper('catalog/image')->init($this->getProduct(), 'thumbnail', $_image->getFile())->resize(392,512); ?>" alt="<?php echo $this->htmlEscape($_image->getLabel()) ?>" title="<?php echo $this->htmlEscape($_image->getLabel()) ?>"/>
            <?php $counter++; ?>
            <?php endforeach; ?>
        </div>  
        <div id="thumbRepo">
            <?php foreach ($this->getGalleryImages() as $_image): ?>       
                <img src="<?php echo $this->helper('catalog/image')->init($this->getProduct(), 'thumbnail', $_image->getFile())->resize(74,96); ?>" alt="<?php echo $this->htmlEscape($_image->getLabel()) ?>" title="<?php echo $this->htmlEscape($_image->getLabel()) ?>"/>
            <?php $counter++; ?>
            <?php endforeach; ?>
        </div>       
<?php endif   ?>
              
<script type="text/javascript">
function loadImage(numImage){
    jQuery('.containerImage').html('<img src="'+jQuery('#imageRepo img').eq(numImage).attr('src')+'" />');
}   
function loadVideo(source){
    jQuery('#videoFrame').attr('src',source);
    jQuery('#videoFrame').show();
}
    
jQuery(document).ready(function(){
    <?php if ( $count >= 1 ): ?>
            var counterJs = 0;
            var numImages = jQuery('#thumbRepo img').length;
            var videoCounter = <?php echo strlen($_product->getVideo())?>;
            var urlVideo = '<?php echo $_product->getVideo();?>';
            
            loadImage(0);
            //alert( jQuery('#imageRepo img').eq(0).attr('src') );
            
            jQuery('#thumbRepo img').each(function(number){
                 
                 if( videoCounter  == 0 ){
                    if(number <= 3){
                        jQuery('.thumb').eq(counterJs).html('<a href="#" onclick="loadImage('+counterJs+');"><img src="'+jQuery(this).attr('src')+'" /></a>');
                        counterJs++;
                    }
                    
                 }
                 else{                
                     if(number <= 2){
                        jQuery('.thumb').eq(counterJs).html('<a href="#" onclick="loadImage('+counterJs+');"><img src="'+jQuery(this).attr('src')+'" /></a>');
                        counterJs++;
                     }
                }
                
            });
            if( videoCounter  == 0 ){
                    jQuery('.thumb').eq(counterJs).html('<a href="#" onclick=""><img src="http://184.106.64.100/mariatash_mc_1702/skin/frontend/mt/default/images/catalog/product/placeholder/thumbnail.jpg" /></a>');
                }
            else{
                jQuery('.thumb').eq(counterJs).html('<a href="#" onclick="loadVideo(\''+urlVideo+'\')"><img src="http://184.106.64.100/mariatash_mc_1702/skin/frontend/mt/default/images/catalog/product/placeholder/thumbnail.jpg" /></a>');
                jQuery('.thumb').eq(counterJs+1).html('<a href="#" onclick=""><img src="http://184.106.64.100/mariatash_mc_1702/skin/frontend/mt/default/images/catalog/product/placeholder/thumbnail.jpg" /></a>');
            }
            
    <?php endif; ?>
  

});

</script>

<div class="gallery">
	<div class="containerImage"><iframe id="videoFrame" frameborder="0"></iframe></div>
	<div class="containerThumb">
		<div class="thumb"></div>
		<div class="thumb"></div>
		<div class="thumb"></div>
		<div class="thumb"></div>
		<div class="thumb"></div>
	</div>
</div>