<?php
/**
 * BelVG LLC.
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the EULA
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://store.belvg.com/BelVG-LICENSE-COMMUNITY.txt
 *
/**********************************************
 *        MAGENTO EDITION USAGE NOTICE        *
 **********************************************/
/* This package designed for Magento COMMUNITY edition
 * BelVG does not guarantee correct work of this extension
 * on any other Magento edition except Magento COMMUNITY edition.
 * BelVG does not provide extension support in case of
 * incorrect edition usage.
/**********************************************
 *        DISCLAIMER                          *
 **********************************************/
/* Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future.
 **********************************************
 * @category   Belvg
 * @package    Belvg_DropDownMenu
 * @copyright  Copyright (c) 2010 - 2012 BelVG LLC. (http://www.belvg.com)
 * @license    http://store.belvg.com/BelVG-LICENSE-COMMUNITY.txt
 */

    $version = Mage::getVersionInfo();
    $version = $version['major'] . $version['minor'] . $version['revision'] . $version['patch'];
?>

<script type="text/javascript">
    Event.observe(window, 'load', function() {
        var ddmenuOverlayColor = new jscolor.color($('ddmenu_settings_overlay_color'), {hash:true});

        jBelvgDd('#ddmenu_animate').append('<div id="ddmenu_test"><a href="javascript:;">Test</a><div class="sub"><img src="<?php echo $this->getSkinUrl("belvg/images/ddmenu/04.png")?>"></div></div>');
        jBelvgDd('#ddmenu_animate_transition_in_easing').change(function() {
            hoverOver();
        });
        jBelvgDd('#ddmenu_animate_transition_out_easing').change(function() {
            hoverOut();
        });
        jBelvgDd('#ddmenu_test').hover(
            function() {
                hoverOver();
            },
            function() {
                hoverOut();
            }
        );
        <?php if ($version < '1500'): ?>
            effectSettingsCheck('in');
            effectSettingsCheck('out');
            jBelvgDd('#ddmenu_animate_transition_in').change(function() {
                effectSettingsCheck('in');
            });
            jBelvgDd('#ddmenu_animate_transition_out').change(function() {
                effectSettingsCheck('out');
            });
        <?php endif ?>
    });
    <?php if ($version < '1500'): ?>
        function effectSettingsCheck(type)
        {
            var value = jBelvgDd('#ddmenu_animate_transition_'+type).val();
            switch (value) {
                case 'fade':
                    effectSettingsShow(type);
                    break;
                case 'slide':
                    effectSettingsShow(type);
                    break;
                default:
                    effectSettingsHide(type);
            }
        }
        
        function effectSettingsShow(type)
        {
            jBelvgDd('#row_ddmenu_animate_transition_'+type+'_easing').show();
            jBelvgDd('#row_ddmenu_animate_speed_'+type).show();
            
            jBelvgDd('#ddmenu_animate_transition_'+type+'_easing').attr('disabled', '');
            jBelvgDd('#ddmenu_animate_speed_'+type).attr('disabled', '')
        }
        
        function effectSettingsHide(type)
        {
            jBelvgDd('#row_ddmenu_animate_transition_'+type+'_easing').hide();
            jBelvgDd('#row_ddmenu_animate_speed_'+type).hide();
            
            jBelvgDd('#ddmenu_animate_transition_'+type+'_easing').attr('disabled', 'disabled');
            jBelvgDd('#ddmenu_animate_speed_'+type).attr('disabled', 'disabled')
        }
    <?php endif ?>

    function hoverOver()
    {
        var transition = jBelvgDd('#ddmenu_animate_transition_in').val();
        var effect     = jBelvgDd('#ddmenu_animate_transition_in_easing').val();
        var speed      = parseInt(jBelvgDd('#ddmenu_animate_speed_in').val());
        var sub        = jBelvgDd('#ddmenu_test .sub');
        if (sub.length) {
            sub.stop();
            sub.attr('style', 'opacity:0');
            sub.hide();

            switch (transition) {
                case 'fade':
                    sub.fadeTo(speed, 1, effect, function(){
                        sub.show();
                    });
                    break;
                case 'slide':
                    sub.css({'opacity':1});
                    sub.slideDown(speed, effect);
                    break;
                default:
                    sub.css({'opacity':1});
                    sub.show();
            }
        }
    }

    function hoverOut()
    {
        var transition = jBelvgDd('#ddmenu_animate_transition_out').val();
        var effect     = jBelvgDd('#ddmenu_animate_transition_out_easing').val();
        var speed      = parseInt(jBelvgDd('#ddmenu_animate_speed_out').val());
        var sub        = jBelvgDd('#ddmenu_test .sub');
        if (sub.length) {
            sub.stop();
            sub.attr('style', 'opacity:1');
            sub.show();

            switch (transition) {
                case 'fade':
                    sub.fadeTo(speed, 0, effect, function(){
                        $(this).hide();
                    });
                    break;
                case 'slide':
                    sub.slideUp(speed, effect);
                    break;
                default:
                    sub.hide();
            }
            methods.overlayHide();
        }
    }

</script>